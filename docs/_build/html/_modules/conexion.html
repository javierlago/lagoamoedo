<!DOCTYPE html>

<html lang="es" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>conexion &#8212; documentación de LagoAmoedo - v:0.0.1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=f63d8bfa" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css?v=e491ac2d" />
    <script src="../_static/documentation_options.js?v=dc1d13be"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=efdbd0b9"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>documentación de LagoAmoedo - v:0.0.1</span></a></h1>
        <h2 class="heading"><span>conexion</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contenidos</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <h1>Código fuente para conexion</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">PyQt6</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtSql</span>
<span class="kn">from</span> <span class="nn">PyQt6.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span>

<span class="kn">import</span> <span class="nn">Ventanas</span>
<span class="kn">import</span> <span class="nn">cliente</span>
<span class="kn">import</span> <span class="nn">conexion</span>
<span class="kn">import</span> <span class="nn">drivers</span>
<span class="kn">from</span> <span class="nn">Facturas</span> <span class="kn">import</span> <span class="n">facturacion</span><span class="p">,</span> <span class="n">facturacion_repository</span>
<span class="kn">import</span> <span class="nn">var</span>


<div class="viewcode-block" id="Conexion">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion">[documentos]</a>
<span class="k">class</span> <span class="nc">Conexion</span><span class="p">:</span>
<div class="viewcode-block" id="Conexion.borrarCliente">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.borrarCliente">[documentos]</a>
    <span class="k">def</span> <span class="nf">borrarCliente</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Método para borrar un cliente de la base de datos según el DNI pasado por parametro.</span>
<span class="sd">        :param : Recibe un string con el DNI que se desea borrar.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">fecha</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">fecha</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
            <span class="n">valor</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;SELECT bajacliente FROM listadoClientes WHERE dnicliente = :dni &#39;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="n">dni</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">valor</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">valor</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">valor</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">valor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fecha</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="n">fecha</span> <span class="o">=</span> <span class="n">fecha</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
                <span class="n">queryFecha</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
                <span class="n">queryFecha</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;update listadoClientes set bajaCliente = :fechabaja where dnicliente = :dni&#39;</span><span class="p">)</span>
                <span class="n">queryFecha</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">dni</span><span class="p">))</span>
                <span class="n">queryFecha</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:fechabaja&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">fecha</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">queryFecha</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                    <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">ventana_info</span><span class="p">(</span><span class="s2">&quot;Se ha dado de baja al empleado&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;El empeado ya esta dado de baja&quot;</span><span class="p">)</span>


        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No se ha podido dar de baja al cliente&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.modificar_cliente">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.modificar_cliente">[documentos]</a>
    <span class="k">def</span> <span class="nf">modificar_cliente</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Modificacion de un cliente de la base de datos.Para realizar la modicicación se debera seleccionar un cliente de la tabla de clientes.Cuando se modifica el cliente se mostrara una ventana indicando que se ha realizado la modificación.Si no se ha modificado el cliente y se ejecuta el metodo se mostrara una ventana indicando que no se han realizado cambios en el cliente.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cliente_a_modificar</span> <span class="o">=</span> <span class="n">cliente</span><span class="o">.</span><span class="n">Cliente</span><span class="o">.</span><span class="n">recuperar_datos</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cliente</span><span class="o">.</span><span class="n">Cliente</span><span class="o">.</span><span class="n">validar_datos</span><span class="p">(</span><span class="n">cliente_a_modificar</span><span class="p">):</span>
                <span class="n">cliente_verificacion</span> <span class="o">=</span> <span class="n">conexion</span><span class="o">.</span><span class="n">Conexion</span><span class="o">.</span><span class="n">buscar_segun_dni_cliente</span><span class="p">(</span><span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">cliente_verificacion</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">cliente_a_modificar</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cliente_a_modificar</span> <span class="o">!=</span> <span class="n">cliente_verificacion</span><span class="p">:</span>
                    <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span>
                        <span class="s2">&quot;update listadoClientes set  razon = :razon , direccion = :direccion ,telefono = :telf , provCliente = :pc , muniCliente = :mc , bajaCliente = :bc where dnicliente = :dni;&quot;</span><span class="p">)</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:dni&quot;</span><span class="p">,</span> <span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:razon&quot;</span><span class="p">,</span> <span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:direccion&quot;</span><span class="p">,</span> <span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:telf&quot;</span><span class="p">,</span> <span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:pc&quot;</span><span class="p">,</span> <span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:mc&quot;</span><span class="p">,</span> <span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:bc&quot;</span><span class="p">,</span> <span class="n">cliente_a_modificar</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                        <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">ventana_info</span><span class="p">(</span><span class="s2">&quot;modificacion realizada&quot;</span><span class="p">)</span>
                        <span class="n">conexion</span><span class="o">.</span><span class="n">Conexion</span><span class="o">.</span><span class="n">mostrarclientes</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">lastError</span><span class="p">()))</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;No se ha modificado el cliente&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;Campos vaios&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">lastError</span><span class="p">())</span></div>


<div class="viewcode-block" id="Conexion.conexion">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.conexion">[documentos]</a>
    <span class="k">def</span> <span class="nf">conexion</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo que establece una conexión a la base de datos.</span>
<span class="sd">        :return: True en cado de que la conexion se realize.</span>
<span class="sd">        :rtype: Boolean</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">var</span><span class="o">.</span><span class="n">bbdd</span> <span class="o">=</span> <span class="s1">&#39;bbdd.sqlite&#39;</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlDatabase</span><span class="o">.</span><span class="n">addDatabase</span><span class="p">(</span><span class="s1">&#39;QSQLITE&#39;</span><span class="p">)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">setDatabaseName</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">bbdd</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">db</span><span class="o">.</span><span class="n">open</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error de conexion&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Base de datos conectada&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Conexion.cargar_provincias">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.cargar_provincias">[documentos]</a>
    <span class="k">def</span> <span class="nf">cargar_provincias</span><span class="p">(</span><span class="n">comboBox</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo que se le pasa por parametro un ComboBox y lo rellena con el resultado de la query realizada a la base de datos.</span>
<span class="sd">        :param : ComboBox que se desea rellenar</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select provincia from provincias&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="n">comboBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="c1"># print(str(query.value(0)))</span>
                    <span class="n">comboBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en la carga del combo prov: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.sel_muni_parametrizado">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.sel_muni_parametrizado">[documentos]</a>
    <span class="k">def</span> <span class="nf">sel_muni_parametrizado</span><span class="p">(</span><span class="n">comboBoxProvincia</span><span class="p">,</span> <span class="n">comboBoxLocalidad</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo que recibe dos comboBox y en funcio de del texto de el primer comboBox rellena el segundo comboBox en funcion del resultado obtenido en la primera query.</span>
<span class="sd">        :param comboBoxLocalidad:</span>
<span class="sd">        :param comboBoxProvincia:</span>
<span class="sd">        :type comboBoxLocalidad:</span>
<span class="sd">        :type comboBoxProvincia:</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">comboBoxLocalidad</span><span class="p">))</span>
            <span class="n">comboBoxLocalidad</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">prov</span> <span class="o">=</span> <span class="n">comboBoxProvincia</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select idprov from provincias where provincia = :prov&quot;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:prov&#39;</span><span class="p">,</span> <span class="n">prov</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">query1</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query1</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select municipio from municipios where idprov = :id&quot;</span><span class="p">)</span>
            <span class="n">query1</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:id&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">query1</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="n">comboBoxLocalidad</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">query1</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">comboBoxLocalidad</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">query1</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en la carga de municipios&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


    <span class="c1">### Cargar los conductores en el combo box</span>
<div class="viewcode-block" id="Conexion.cargar_cmb_drivers_facturacion">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.cargar_cmb_drivers_facturacion">[documentos]</a>
    <span class="k">def</span> <span class="nf">cargar_cmb_drivers_facturacion</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo que rellena un combobox de conductores en funcion del resultado de una query en la que se solicitan todos los conductores que estan dados de alta en la base de datos.Estes datos son formateados de una manera especifia para que solo se muestre el codigo y los apellido del conductor en el comboBox.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cmb_listado_conductores</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select codigo, apeldri from drivers where bajadri = &#39;&#39; order by codigo&quot;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cmb_listado_conductores</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cmb_listado_conductores</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;  ||  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en la carga de municipios&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.guardardri">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.guardardri">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">guardardri</span><span class="p">(</span><span class="n">newdriver</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo para guardar o modificar un conductor en la base de datos.</span>
<span class="sd">        Recibe por parametro una lista con los datos del conductor a guardar o modificar.Antes de relizar la query se verifica si ese conductor existe en la base de datos para saber si se guarda o se modifica.</span>

<span class="sd">        :param newdriver:</span>
<span class="sd">        :type newdriver:</span>
<span class="sd">        :return: Devuelve true si se inserta o midifica  un conductor en la base de datos.</span>
<span class="sd">        :rtype: Boolean</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query2</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query2</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select * from drivers where dnidri = :dni&quot;</span><span class="p">)</span>
            <span class="n">query2</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="n">newdriver</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">newdriver</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">query2</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;insert into drivers(dnidri, altadri, apeldri, nombredri, direcciondri, provdri, &#39;</span>
                              <span class="s1">&#39;munidri, movildri, salario, carnet, bajadri ) VALUES (:dni, :alta, :apel, :nombre, :direccion, &#39;</span>
                              <span class="s1">&#39;:provincia, :municipio, :movil, :salario, :carnet, :bajadri)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newdriver</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;UPDATE drivers SET altadri = :alta, apeldri = :apel, nombredri = :nombre, direcciondri &quot;</span>
                              <span class="s2">&quot;= :direccion, provdri = :provincia, munidri = :municipio, movildri = :movil, &quot;</span>
                              <span class="s2">&quot;salario = :salario, carnet = :carnet ,bajadri = :bajadri WHERE dnidri = :dni;&quot;</span><span class="p">)</span>

            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:alta&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:apel&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:nombre&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:direccion&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:provincia&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:municipio&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:movil&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:salario&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:carnet&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">9</span><span class="p">]))</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:bajadri&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">newdriver</span><span class="p">[</span><span class="mi">10</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al ejecutar la consulta:&quot;</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">lastError</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="k">return</span> <span class="kc">False</span>


        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al guardar el conductor&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.modificar">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.modificar">[documentos]</a>
    <span class="k">def</span> <span class="nf">modificar</span><span class="p">(</span><span class="n">driver</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo usado para modificar un conductor existente en la base de datos.Recibe por parametro una lista con los nuevos datos.</span>
<span class="sd">        Si se ejecuta el metodo y los datos no ha modificado respeto a lo existentes en la base de datos se mostrara un ventana informando de que no se han realizado cambios y en caso de que se realizen cambios tambiens se informa mediante una ventana al usuario.</span>
<span class="sd">        :param: Lista con los datos a modifacar.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">registro</span> <span class="o">=</span> <span class="n">conexion</span><span class="o">.</span><span class="n">Conexion</span><span class="o">.</span><span class="n">buscar_segun_codigo</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">registro</span> <span class="o">!=</span> <span class="n">driver</span><span class="p">:</span>
                <span class="n">nuevo_array</span> <span class="o">=</span> <span class="n">driver</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">driver</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
                <span class="n">driver</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">drivers</span><span class="o">.</span><span class="n">Drivers</span><span class="o">.</span><span class="n">validar_datos</span><span class="p">(</span><span class="n">nuevo_array</span><span class="p">):</span>
                    <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;Campos Vacios&quot;</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span>
                        <span class="s1">&#39;UPDATE drivers SET altadri = :alta, apeldri = :apel, nombredri = :nombre, direcciondri = :direccion, provdri = :provincia, munidri = :municipio, movildri = :movil, salario = :salario, carnet = :carnet , bajadri = :bajadri WHERE dnidri = :dni &#39;</span><span class="p">)</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:alta&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:apel&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:nombre&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:direccion&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:provincia&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:municipio&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:movil&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:salario&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:carnet&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">9</span><span class="p">]))</span>
                    <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:bajadri&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">driver</span><span class="p">[</span><span class="mi">10</span><span class="p">]))</span>

                    <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                        <span class="n">mbox</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="p">()</span>
                        <span class="n">mbox</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Aviso&#39;</span><span class="p">)</span>
                        <span class="n">mbox</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                        <span class="n">mbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Se ha modificado la tabla&#39;</span><span class="p">)</span>
                        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;./img/taxiIcon.png&#39;</span><span class="p">)</span>
                        <span class="n">mbox</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
                        <span class="n">mbox</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;Dni ya esta en la base de datos&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;No se han modificado los campos&quot;</span><span class="p">)</span>
                <span class="c1"># select de los datos de los conductores de la base de datos</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al guardar el conductor&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.mostrardrivers">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.mostrardrivers">[documentos]</a>
    <span class="k">def</span> <span class="nf">mostrardrivers</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo que carga la tabla de conductores mostrando</span>
<span class="sd">        todos los conductoes existentes en la base de datos relizando una consulta</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">registros</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">query1</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query1</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select codigo ,apeldrI ,nombredri ,movildri, &quot;</span>
                           <span class="s2">&quot;carnet,bajadri from drivers&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query1</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query1</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">query1</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">query1</span><span class="o">.</span><span class="n">record</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>
                    <span class="n">registros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

            <span class="n">drivers</span><span class="o">.</span><span class="n">Drivers</span><span class="o">.</span><span class="n">cargartabla</span><span class="p">(</span><span class="n">registros</span><span class="p">)</span>



        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error al mostrar resultados&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.mostrarclientes">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.mostrarclientes">[documentos]</a>
    <span class="k">def</span> <span class="nf">mostrarclientes</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Metodo que realiza una consulta a la base de datos y carga la tabla de clientes con los datos obtenidos de dicha consulta.</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">registros</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">query1</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query1</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select codigo , razon ,telefono, provCliente, bajaCliente from listadoClientes&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">query1</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query1</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">query1</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">query1</span><span class="o">.</span><span class="n">record</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>
                    <span class="n">registros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">query1</span><span class="o">.</span><span class="n">lastError</span><span class="p">())</span>
            <span class="n">cliente</span><span class="o">.</span><span class="n">Cliente</span><span class="o">.</span><span class="n">cargartabla</span><span class="p">(</span><span class="n">registros</span><span class="p">)</span>



        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error al mostrar resultados&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.buscar_segun_codigo">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.buscar_segun_codigo">[documentos]</a>
    <span class="k">def</span> <span class="nf">buscar_segun_codigo</span><span class="p">(</span><span class="n">codigo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Metodo para buscar un driver en la tabla de driver a traves de un código</span>
<span class="sd">        :param : recibe un código para buscar en la tabla de drivers</span>
<span class="sd">        :return: Registro de el driver donde coincida con el codigo</span>
<span class="sd">        :rtype: Array de datos del driver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">registro</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM drivers WHERE codigo = :codigo&quot;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:codigo&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">codigo</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
                        <span class="n">registro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">registro</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en fichero conexion datos de 1 driver: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.buscar_segun_codigo_cliente">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.buscar_segun_codigo_cliente">[documentos]</a>
    <span class="k">def</span> <span class="nf">buscar_segun_codigo_cliente</span><span class="p">(</span><span class="n">codigo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Busca un cliente en la base de datos según su código.</span>

<span class="sd">        :param : codigo: Código del cliente a buscar (tipo String).</span>
<span class="sd">        :return: Lista con los registros encontrados para el cliente.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">registro</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM listadoClientes WHERE codigo = :codigo&quot;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:codigo&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">codigo</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
                        <span class="n">registro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">registro</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en fichero conexion datos de 1 driver: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.buscar_segun_dni">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.buscar_segun_dni">[documentos]</a>
    <span class="k">def</span> <span class="nf">buscar_segun_dni</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">registro</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM drivers WHERE dnidri = :dnidri&quot;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dnidri&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">dni</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
                        <span class="n">registro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;Dni no esta en la base de datos&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">registro</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">rbtAlta</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">registro</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al buscar segun dni: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.buscar_segun_dni_cliente">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.buscar_segun_dni_cliente">[documentos]</a>
    <span class="k">def</span> <span class="nf">buscar_segun_dni_cliente</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">           Busca un conductor en la base de datos según su número de DNI.</span>

<span class="sd">           :param dni: Número de DNI del conductor a buscar (tipo String).</span>
<span class="sd">           :return: Lista con los registros encontrados para el conductor.</span>
<span class="sd">           :rtype: list</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">registro</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM listadoClientes WHERE dnicliente = :dnidri&quot;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dnidri&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">dni</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
                        <span class="n">registro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>

            <span class="k">if</span> <span class="n">registro</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">var</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">rbtAlta</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">registro</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al buscar segun dni: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.borrarDriver">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.borrarDriver">[documentos]</a>
    <span class="k">def</span> <span class="nf">borrarDriver</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Da de baja a un conductor en la base de datos según su número de DNI.</span>

<span class="sd">            :param dni: Número de DNI del conductor a dar de baja (tipo String).</span>
<span class="sd">            :return: None</span>
<span class="sd">            &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">fecha</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">fecha</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
            <span class="n">valor</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;SELECT bajadri FROM drivers WHERE dnidri = :dni &#39;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="n">dni</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">valor</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">valor</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">fecha</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="n">fecha</span> <span class="o">=</span> <span class="n">fecha</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)</span>
                <span class="n">queryFecha</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
                <span class="n">queryFecha</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;update drivers set bajadri = :fechabaja, altadri = :altadri where dnidri = :dni&#39;</span><span class="p">)</span>
                <span class="n">queryFecha</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">dni</span><span class="p">))</span>
                <span class="n">queryFecha</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:fechabaja&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">fecha</span><span class="p">))</span>
                <span class="n">queryFecha</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:altadri&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">queryFecha</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>

                    <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">ventana_info</span><span class="p">(</span><span class="s2">&quot;Se ha dado de baja al conductor&quot;</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;No se ha podido dar de baja el conductor&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Ventanas</span><span class="o">.</span><span class="n">Ventanas</span><span class="o">.</span><span class="n">mensaje_warning</span><span class="p">(</span><span class="s2">&quot;El empleado ya esta dado de baja&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No se ha podido dar de baja al conductor&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.select_all_driver">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.select_all_driver">[documentos]</a>
    <span class="k">def</span> <span class="nf">select_all_driver</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">           Realiza una consulta para obtener todos los registros de conductores en la base de datos.</span>

<span class="sd">           :return: Lista de listas que contiene los registros de conductores.</span>
<span class="sd">           :rtype: list</span>
<span class="sd">           &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Inicializar una lista vacía para almacenar los resultados de la consulta</span>
            <span class="n">registro</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM drivers order by apeldri&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="c1"># Crear una lista &#39;row&#39; que contiene los valores de cada columna en el resultado actual</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">record</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>
                    <span class="n">registro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">registro</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al buscar segun dni: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.guardarCliente">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.guardarCliente">[documentos]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">guardarCliente</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Guarda un nuevo cliente en la base de datos o actualiza un cliente existente.</span>

<span class="sd">            :param nuevoCliente: Lista que contiene la información del nuevo cliente.</span>
<span class="sd">                                 [DNI, Razón social, Dirección, Teléfono, Provincia, Municipio, Estado de baja]</span>
<span class="sd">            :type nuevoCliente: list</span>
<span class="sd">            :return: True si la operación se realiza con éxito, False en caso contrario.</span>
<span class="sd">            :rtype: bool</span>
<span class="sd">            &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query2</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query2</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select * from listadoClientes  where dnicliente = :dni&quot;</span><span class="p">)</span>
            <span class="n">query2</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">query2</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span> <span class="ow">and</span> <span class="n">query2</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="ow">and</span> <span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;update listadoClientes set bajaCliente = :bajaCliente where dnicliente = :dni&#39;</span><span class="p">)</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:bajaCliente&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span>
                    <span class="s1">&#39;insert into listadoClientes (dnicliente, razon, direccion, telefono, provCliente, muniCliente, &#39;</span>
                    <span class="s1">&#39;bajaCliente ) VALUES (:dni, :razon, :direccion, :telefono, :provincia, :municipio, :bajaCliente)&#39;</span><span class="p">)</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:dni&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:razon&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:direccion&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:telefono&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:provincia&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:municipio&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:bajaCliente&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nuevoCliente</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al ejecutar la consulta:&quot;</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">lastError</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="c1"># select de los datos de los conductores de la base de datos</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al guardar el conductor&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.dni_existe">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.dni_existe">[documentos]</a>
    <span class="k">def</span> <span class="nf">dni_existe</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Verifica si un DNI existe en la base de datos de clientes.</span>

<span class="sd">            :param dni: Número de DNI a verificar (tipo String).</span>
<span class="sd">            :return: True si el DNI se encuentra en la base de datos, False en caso contrario.</span>
<span class="sd">            :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;select * from listadoClientes where dnicliente= :dni&quot;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:dni&quot;</span><span class="p">,</span> <span class="n">dni</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span> <span class="ow">and</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;El DNI se encuentra en la base de datos, devuelve True&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># El DNI no se encuentra en la base de datos, devuelve False</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en el método de validar si DNI existe:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="Conexion.dni_existe_no_esta_baja">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.dni_existe_no_esta_baja">[documentos]</a>
    <span class="k">def</span> <span class="nf">dni_existe_no_esta_baja</span><span class="p">(</span><span class="n">dni</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">          Verifica si un DNI existe en la base de datos de clientes y el cliente no está dado de baja.</span>

<span class="sd">          :param dni: Número de DNI a verificar (tipo String).</span>
<span class="sd">          :return: True si el DNI existe y el cliente no está dado de baja, False en caso contrario.</span>
<span class="sd">          :rtype: bool</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM listadoClientes WHERE dnicliente = :dni AND bajacliente IS &#39;&#39;&quot;</span><span class="p">)</span>
            <span class="n">query</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s2">&quot;:dni&quot;</span><span class="p">,</span> <span class="n">dni</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span> <span class="ow">and</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                <span class="c1"># el dni exite en la base de datos y no esta de baja</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># El DNI no se encuentra en la base de datos, devuelve False</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en el método de validar si DNI existe y el cliente no esta dado de baja&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>


        <span class="c1">### ZONA FACTURACION ###</span>

<div class="viewcode-block" id="Conexion.cargar_facturas">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.cargar_facturas">[documentos]</a>
    <span class="k">def</span> <span class="nf">cargar_facturas</span><span class="p">(</span><span class="bp">self</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">         Carga las facturas desde la base de datos y las muestra en una tabla.</span>

<span class="sd">         :param self: Puede ser un objeto de la clase que llama al método o None si es un método estático.</span>
<span class="sd">         :type self: object or None</span>
<span class="sd">         :return: None</span>
<span class="sd">         &#39;&#39;&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">registros_facturas</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;select  numFactura,dniCliente from facturas&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">record</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">())]</span>
                    <span class="n">registros_facturas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                    <span class="n">facturacion</span><span class="o">.</span><span class="n">Facturacion</span><span class="o">.</span><span class="n">cargartabla</span><span class="p">(</span><span class="n">registros_facturas</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al cargar facturas&quot;</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">lastError</span><span class="p">())</span></div>


<div class="viewcode-block" id="Conexion.provincia_segun_municipio">
<a class="viewcode-back" href="../src/conexion.html#conexion.Conexion.provincia_segun_municipio">[documentos]</a>
    <span class="k">def</span> <span class="nf">provincia_segun_municipio</span><span class="p">(</span><span class="n">nombre_municipio</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Obtiene el nombre de la provincia correspondiente a un municipio dado.</span>

<span class="sd">        :param nombre_municipio: Nombre del municipio para el cual se desea obtener la provincia.</span>
<span class="sd">        :type nombre_municipio: str</span>
<span class="sd">        :return: Nombre de la provincia correspondiente al municipio.</span>
<span class="sd">        :rtype: str or None</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">nombre_provincia</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">query_obtener_provincia</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query_obtener_provincia</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;SELECT p.provincia FROM provincias p &#39;</span>
                                            <span class="s1">&#39;INNER JOIN municipios m ON p.idprov = m.idprov &#39;</span>
                                            <span class="s1">&#39;WHERE m.municipio = :municipio&#39;</span><span class="p">)</span>
            <span class="n">query_obtener_provincia</span><span class="o">.</span><span class="n">bindValue</span><span class="p">(</span><span class="s1">&#39;:municipio&#39;</span><span class="p">,</span> <span class="n">nombre_municipio</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query_obtener_provincia</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="k">while</span> <span class="n">query_obtener_provincia</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="n">nombre_provincia</span> <span class="o">=</span> <span class="n">query_obtener_provincia</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


            <span class="k">return</span> <span class="n">nombre_provincia</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al obtener una provincia según el municipio:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></div>
</div>

</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contenidos</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Javier.
      Creado usando <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>