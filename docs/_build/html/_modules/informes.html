<!DOCTYPE html>

<html lang="es" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>informes &#8212; documentación de LagoAmoedo - v:0.0.1</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=f63d8bfa" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css?v=e491ac2d" />
    <script src="../_static/documentation_options.js?v=dc1d13be"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=efdbd0b9"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>documentación de LagoAmoedo - v:0.0.1</span></a></h1>
        <h2 class="heading"><span>informes</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contenidos</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <h1>Código fuente para informes</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">PyQt6</span> <span class="kn">import</span> <span class="n">QtSql</span>
<span class="kn">from</span> <span class="nn">reportlab.pdfgen</span> <span class="kn">import</span> <span class="n">canvas</span>
<span class="kn">import</span> <span class="nn">var</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">var</span>
<span class="kn">from</span> <span class="nn">svglib.svglib</span> <span class="kn">import</span> <span class="n">svg2rlg</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>


<div class="viewcode-block" id="informes">
<a class="viewcode-back" href="../src/informes.html#informes.informes">[documentos]</a>
<span class="k">class</span> <span class="nc">informes</span><span class="p">:</span>
    <span class="k">global</span> <span class="n">contador</span>

<div class="viewcode-block" id="informes.reportclientes">
<a class="viewcode-back" href="../src/informes.html#informes.informes.reportclientes">[documentos]</a>
    <span class="k">def</span> <span class="nf">reportclientes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           Método para generar un informe en formato PDF de la lista de clientes.</span>

<span class="sd">           :param self: Referencia al objeto actual.</span>
<span class="sd">           :type self: object</span>

<span class="sd">           :raises: Exception: Se produce si hay algún error durante la ejecución del informe.</span>

<span class="sd">           :return: None</span>

<span class="sd">           Descripción:</span>
<span class="sd">           Este método genera un informe en formato PDF que contiene una lista de clientes. El informe incluye los siguientes campos:</span>
<span class="sd">           Código, DNI, Razón social, Municipio, Provincia, y Estado de baja del cliente.</span>
<span class="sd">           Los datos se obtienen de una base de datos y se ordenan por la razón social del cliente.</span>
<span class="sd">           &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">contador</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">fecha</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y_%m_</span><span class="si">%d</span><span class="s1">_%H_%M_%S&#39;</span><span class="p">)</span>
            <span class="n">nombre</span> <span class="o">=</span> <span class="n">fecha</span> <span class="o">+</span> <span class="s1">&#39;_listadoclientes.pdf&#39;</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="s1">&#39;informes</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">nombre</span><span class="p">)</span>
            <span class="n">titulo</span> <span class="o">=</span> <span class="s1">&#39;Listado de Clientes&#39;</span>
            <span class="n">informes</span><span class="o">.</span><span class="n">top_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
            <span class="n">informes</span><span class="o">.</span><span class="n">foot_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Codigo&#39;</span><span class="p">,</span> <span class="s1">&#39;DNI&#39;</span><span class="p">,</span> <span class="s1">&#39;Razon&#39;</span><span class="p">,</span> <span class="s1">&#39;Municipico&#39;</span><span class="p">,</span> <span class="s1">&#39;Provincia&#39;</span><span class="p">,</span> <span class="s1">&#39;Baja Cliente&#39;</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">print_Titulo</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># codigo</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># dni</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># razon</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>  <span class="c1"># Municipio</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">410</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>  <span class="c1"># Provincia</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>  <span class="c1"># Fecha</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">670</span><span class="p">)</span>

            <span class="n">print_Titulo</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

            <span class="c1"># Obtencion de datos de la base de datos</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span>
                <span class="s1">&#39;select codigo ,dnicliente,razon, muniCliente, provCliente,bajaCliente from listadoclientes order by razon&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="n">j</span> <span class="o">=</span> <span class="mi">635</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">80</span><span class="p">:</span>
                        <span class="n">contador</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">showPage</span><span class="p">()</span>  <span class="c1"># creamos una pagina nueva</span>
                        <span class="n">informes</span><span class="o">.</span><span class="n">top_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
                        <span class="n">informes</span><span class="o">.</span><span class="n">foot_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
                        <span class="n">print_Titulo</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
                        <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
                        <span class="n">j</span> <span class="o">=</span> <span class="mi">635</span>

                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
                    <span class="n">dni</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;XXXXXX&#39;</span> <span class="o">+</span> <span class="n">dni</span><span class="p">[</span><span class="mi">6</span><span class="p">:])</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">410</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
                    <span class="n">j</span> <span class="o">-=</span> <span class="mi">20</span>

            <span class="c1">## var.report.drawString(250,250,&#39;Mi primer informe&#39;)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">root_path</span> <span class="o">=</span> <span class="s1">&#39;.</span><span class="se">\\</span><span class="s1">informes</span><span class="se">\\</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">root_path</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">nombre</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">root_path</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error en la ejecucion del informe de clientes&quot;</span><span class="p">,</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="informes.report_conductores">
<a class="viewcode-back" href="../src/informes.html#informes.informes.report_conductores">[documentos]</a>
    <span class="k">def</span> <span class="nf">report_conductores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Método para generar un informe en formato PDF del listado de conductores.</span>

<span class="sd">         :param self: Referencia al objeto actual.</span>
<span class="sd">         :type self: object</span>

<span class="sd">         :raises: Exception: Se produce si hay algún error durante la ejecución del informe.</span>

<span class="sd">         :return: None</span>

<span class="sd">         Descripción:</span>
<span class="sd">         Este método genera un informe en formato PDF que contiene un listado de conductores. El informe incluye los siguientes campos:</span>
<span class="sd">         Código, Apellidos, Nombre, Móvil, Licencias, y Fecha de baja.</span>
<span class="sd">         Los datos se obtienen de una base de datos y se ordenan por los apellidos de los conductores.</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">fecha</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y_%m_</span><span class="si">%d</span><span class="s1">_%H_%M_%S&#39;</span><span class="p">)</span>
            <span class="n">nombre</span> <span class="o">=</span> <span class="n">fecha</span> <span class="o">+</span> <span class="s1">&#39;_listadoconductores.pdf&#39;</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="s1">&#39;informes</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">nombre</span><span class="p">)</span>
            <span class="n">titulo</span> <span class="o">=</span> <span class="s1">&#39;Listado de Conductores&#39;</span>
            <span class="n">informes</span><span class="o">.</span><span class="n">top_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
            <span class="n">informes</span><span class="o">.</span><span class="n">foot_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Codigo&#39;</span><span class="p">,</span> <span class="s1">&#39;Apellidos&#39;</span><span class="p">,</span> <span class="s1">&#39;Nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;Móvil&#39;</span><span class="p">,</span> <span class="s1">&#39;Licencias&#39;</span><span class="p">,</span> <span class="s1">&#39;Fecha Baja&#39;</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">print_Titulo</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># codigo</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># Apellidos</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># Nombre</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>  <span class="c1"># Móvil</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">410</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>  <span class="c1"># Licencias</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="mi">675</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>  <span class="c1"># Fecha Baja</span>
                <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">670</span><span class="p">)</span>

            <span class="n">print_Titulo</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

            <span class="c1"># Obtencion de datos de la base de datos</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">QtSql</span><span class="o">.</span><span class="n">QSqlQuery</span><span class="p">()</span>
            <span class="n">query</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s1">&#39;select codigo ,apeldri,nombredri,movildri,carnet,bajadri from drivers order by apeldri&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mi">635</span>
                <span class="k">while</span> <span class="n">query</span><span class="o">.</span><span class="n">next</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mi">80</span><span class="p">:</span>
                        <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">showPage</span><span class="p">()</span>  <span class="c1"># creamos una pagina nueva</span>
                        <span class="n">informes</span><span class="o">.</span><span class="n">top_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
                        <span class="n">informes</span><span class="o">.</span><span class="n">foot_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">)</span>
                        <span class="n">print_Titulo</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
                        <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="mi">635</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">410</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">480</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
                    <span class="n">y</span> <span class="o">-=</span> <span class="mi">20</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">root_path</span> <span class="o">=</span> <span class="s1">&#39;.</span><span class="se">\\</span><span class="s1">informes</span><span class="se">\\</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">root_path</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">nombre</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">root_path</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error en la ejecucion del informe&quot;</span><span class="p">,</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="informes.top_informe">
<a class="viewcode-back" href="../src/informes.html#informes.informes.top_informe">[documentos]</a>
    <span class="k">def</span> <span class="nf">top_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           Función para agregar el encabezado de un informe en un documento PDF.</span>

<span class="sd">           :param titulo: Título del informe.</span>
<span class="sd">           :type titulo: str</span>

<span class="sd">           :return: None</span>

<span class="sd">           Descripción:</span>
<span class="sd">           Esta función agrega el encabezado de un informe en un documento PDF, incluyendo el nombre de la empresa,</span>
<span class="sd">           el título del informe, el logotipo de la empresa y la información de contacto.</span>
<span class="sd">           &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">logo</span> <span class="o">=</span> <span class="s1">&#39;.</span><span class="se">\\</span><span class="s1">img</span><span class="se">\\</span><span class="s1">IconoInfome.png&#39;</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">785</span><span class="p">,</span> <span class="s1">&#39;Trasnsportes Teis&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">695</span><span class="p">,</span> <span class="n">titulo</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">690</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">690</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span><span class="n">logo</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">725</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">770</span><span class="p">,</span> <span class="s1">&#39;CIF:A12345678&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">755</span><span class="p">,</span> <span class="s1">&#39;Avd Galicia 101&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">740</span><span class="p">,</span> <span class="s1">&#39;Vigo - 36216 - España&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">725</span><span class="p">,</span> <span class="s1">&#39;Telefono: 986 123 456&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">710</span><span class="p">,</span> <span class="s1">&#39;e-mail carteis@gmail.com&#39;</span><span class="p">)</span>


        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="informes.top_informe_factura">
<a class="viewcode-back" href="../src/informes.html#informes.informes.top_informe_factura">[documentos]</a>
    <span class="k">def</span> <span class="nf">top_informe_factura</span><span class="p">(</span><span class="n">titulo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Función para agregar el encabezado de una factura en un documento PDF.</span>

<span class="sd">            :param titulo: Título de la factura.</span>
<span class="sd">            :type titulo: str</span>

<span class="sd">            :return: None</span>

<span class="sd">            Descripción:</span>
<span class="sd">            Esta función agrega el encabezado de una factura en un documento PDF, incluyendo el nombre de la empresa,</span>
<span class="sd">            el título de la factura, el logotipo de la empresa y la información de contacto.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">logo</span> <span class="o">=</span> <span class="s1">&#39;.</span><span class="se">\\</span><span class="s1">img</span><span class="se">\\</span><span class="s1">IconoInfome.png&#39;</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">785</span><span class="p">,</span> <span class="s1">&#39;Trasnsportes Teis&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">645</span><span class="p">,</span> <span class="n">titulo</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">635</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">635</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span><span class="n">logo</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">725</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">770</span><span class="p">,</span> <span class="s1">&#39;CIF:A12345678&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">755</span><span class="p">,</span> <span class="s1">&#39;Avd Galicia 101&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">740</span><span class="p">,</span> <span class="s1">&#39;Vigo - 36216 - España&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">725</span><span class="p">,</span> <span class="s1">&#39;Telefono: 986 123 456&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">710</span><span class="p">,</span> <span class="s1">&#39;e-mail carteis@gmail.com&#39;</span><span class="p">)</span>


        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="informes.foot_informe">
<a class="viewcode-back" href="../src/informes.html#informes.informes.foot_informe">[documentos]</a>
    <span class="k">def</span> <span class="nf">foot_informe</span><span class="p">(</span><span class="n">titulo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Función para agregar el pie de página en un documento PDF de informe.</span>

<span class="sd">            :param titulo: Título del informe.</span>
<span class="sd">            :type titulo: str</span>

<span class="sd">            :return: None</span>

<span class="sd">            Descripción:</span>
<span class="sd">            Esta función agrega el pie de página en un documento PDF de informe, incluyendo la fecha y hora de creación del informe,</span>
<span class="sd">            el título del informe y el número de página actual.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">525</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
            <span class="n">fecha</span> <span class="o">=</span> <span class="n">fecha</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y %H:%M:%S&#39;</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">fecha</span><span class="p">))</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">titulo</span><span class="p">))</span>
            <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="mi">490</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Pagina </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">var</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">getPageNumber</span><span class="p">()))</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>
</div>



</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contenidos</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Javier.
      Creado usando <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>